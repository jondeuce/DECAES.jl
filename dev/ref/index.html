<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API Reference · DECAES.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="DECAES.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">DECAES.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../cli/">Command Line Interface</a></li><li class="is-active"><a class="tocitem" href>API Reference</a><ul class="internal"><li><a class="tocitem" href="#t2map"><span><span>$T_2$</span>-distribution mapping</span></a></li><li><a class="tocitem" href="#t2part"><span><span>$T_2$</span>-parts and the myelin water fraction</span></a></li><li><a class="tocitem" href="#nnls"><span>NNLS analysis</span></a></li><li><a class="tocitem" href="#epg"><span>Extended phase graph algorithm</span></a></li><li><a class="tocitem" href="#main"><span>Main entrypoint function</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API Reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API Reference</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/jondeuce/DECAES.jl/blob/master/docs/src/ref.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="API-Reference"><a class="docs-heading-anchor" href="#API-Reference">API Reference</a><a id="API-Reference-1"></a><a class="docs-heading-anchor-permalink" href="#API-Reference" title="Permalink"></a></h1><ul><li><a href="#DECAES.T2mapOptions"><code>DECAES.T2mapOptions</code></a></li><li><a href="#DECAES.T2partOptions"><code>DECAES.T2partOptions</code></a></li><li><a href="#DECAES.EPGdecaycurve"><code>DECAES.EPGdecaycurve</code></a></li><li><a href="#DECAES.T2mapSEcorr"><code>DECAES.T2mapSEcorr</code></a></li><li><a href="#DECAES.T2partSEcorr"><code>DECAES.T2partSEcorr</code></a></li><li><a href="#DECAES.lcurve_corner"><code>DECAES.lcurve_corner</code></a></li><li><a href="#DECAES.lsqnonneg"><code>DECAES.lsqnonneg</code></a></li><li><a href="#DECAES.lsqnonneg_chi2"><code>DECAES.lsqnonneg_chi2</code></a></li><li><a href="#DECAES.lsqnonneg_gcv"><code>DECAES.lsqnonneg_gcv</code></a></li><li><a href="#DECAES.lsqnonneg_lcurve"><code>DECAES.lsqnonneg_lcurve</code></a></li><li><a href="#DECAES.main"><code>DECAES.main</code></a></li></ul><h2 id="t2map"><a class="docs-heading-anchor" href="#t2map"><span>$T_2$</span>-distribution mapping</a><a id="t2map-1"></a><a class="docs-heading-anchor-permalink" href="#t2map" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="DECAES.T2mapOptions" href="#DECAES.T2mapOptions"><code>DECAES.T2mapOptions</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">T2mapOptions(; kwargs...)
T2mapOptions(image::Array{T,4}; kwargs...) where {T}</code></pre><p>Options structure for <a href="#DECAES.T2mapSEcorr"><code>T2mapSEcorr</code></a>. This struct collects keyword arguments passed to <code>T2mapSEcorr</code>, performs checks on parameter types and values, and assigns default values to unspecified parameters.</p><p><strong>Arguments</strong></p><ul><li><p><code>legacy::Bool</code></p><p>Perform T2-mapping using legacy algorithms. Default: false</p></li><li><p><code>MatrixSize::Tuple{Int64, Int64, Int64}</code></p><p>Size of first 3 dimensions of input 4D image. This argument has no default, but is inferred automatically as <code>size(image)[1:3]</code> when calling <code>T2mapSEcorr(image; kwargs...)</code>.</p></li><li><p><code>nTE::Int64</code></p><p>Number of echoes in input signal. This argument is has no default, but is inferred automatically as <code>size(image, 4)</code> when calling <code>T2mapSEcorr(image; kwargs...)</code>.</p></li><li><p><code>TE::Real</code></p><p>Interecho spacing (Units: seconds). This argument has no default.</p></li><li><p><code>nT2::Int64</code></p><p>Number of T2 times to estimate in the multi-exponential analysis. This argument has no default.</p></li><li><p><code>T2Range::Tuple{T, T} where T&lt;:Real</code></p><p>Tuple of min and max T2 values (Units: seconds). This argument has no default.</p></li><li><p><code>T1::Real</code></p><p>Assumed value of T1 (Units: seconds). Default: 1.0</p></li><li><p><code>Threshold::Real</code></p><p>First echo intensity cutoff for empty voxels. Default: if !legacy     0.0 else     200.0 end</p></li><li><p><code>RefConAngle::Real</code></p><p>Refocusing pulse control angle for stimulated echo correction (Units: degrees). Default: 180.0</p></li><li><p><code>MinRefAngle::Real</code></p><p>Minimum refocusing angle for flip angle optimization (Units: degrees). Default: 50.0</p></li><li><p><code>nRefAngles::Int64</code></p><p>During flip angle optimization, goodness of fit is checked for up to <code>nRefAngles</code> angles in the range <code>[MinRefAngle, 180]</code>. The optimal angle is then determined through interpolation from these samples. Default: if !legacy     32 else     8 end</p></li><li><p><code>nRefAnglesMin::Int64</code></p><p>Initial number of angles to check during flip angle optimization before refinement near likely optima. Setting <code>nRefAnglesMin</code> equal to <code>nRefAngles</code> forces all angles to be checked. Default: if !legacy     min(5, nRefAngles) else     nRefAngles end</p></li><li><p><code>Reg::String</code></p><p>Regularization routine to use. One of &quot;none&quot;, &quot;chi2&quot;, &quot;gcv&quot;, or &quot;lcurve&quot;, representing no regularization, <code>Chi2Factor</code>-based Tikhonov regularization, Generalized Cross-Validation method, or L-Curve based regularization, respectively.</p></li><li><p><code>Chi2Factor::Union{Nothing, T} where T&lt;:Real</code></p><p>Constraint on <span>$\chi^2$</span> used for regularization when <code>Reg == &quot;chi2&quot;</code>. Default: nothing</p></li><li><p><code>SetFlipAngle::Union{Nothing, T} where T&lt;:Real</code></p><p>Instead of optimizing flip angle, use <code>SetFlipAngle</code> for all voxels (Units: degrees). Default: nothing</p></li><li><p><code>SaveResidualNorm::Bool</code></p><p>Boolean flag to include a 3D array of the <span>$\ell^2$</span>-norms of the residuals from the NNLS fits in the output maps dictionary. Default: false</p></li><li><p><code>SaveDecayCurve::Bool</code></p><p>Boolean flag to include a 4D array of the time domain decay curves resulting from the NNLS fits in the output maps dictionary. Default: false</p></li><li><p><code>SaveRegParam::Bool</code></p><p>Boolean flag to include 3D arrays of the regularization parameters <span>$\mu$</span> and resulting <span>$\chi^2$</span>-factors in the output maps dictionary. Default: false</p></li><li><p><code>SaveNNLSBasis::Bool</code></p><p>Boolean flag to include a 5D (or 2D if <code>SetFlipAngle</code> is used) array of NNLS basis matrices in the output maps dictionary. Default: SetFlipAngle !== nothing</p></li><li><p><code>Silent::Bool</code></p><p>Suppress printing to the console. Default: false</p></li></ul><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The 5D array that is saved when <code>SaveNNLSBasis</code> is set to <code>true</code> has dimensions <code>MatrixSize x nTE x nT2</code>, and therefore is typically extremely large. If the flip angle is fixed via <code>SetFlipAngle</code>, however, this is not an issue as only the unique <code>nTE x nT2</code> 2D basis matrix is saved.</p></div></div><p>See also:</p><ul><li><a href="#DECAES.T2mapSEcorr"><code>T2mapSEcorr</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jondeuce/DECAES.jl/blob/541249eca404be1e6e3442de8d780500c42cd6cb/src/types.jl#L1-L18">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DECAES.T2mapSEcorr" href="#DECAES.T2mapSEcorr"><code>DECAES.T2mapSEcorr</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">T2mapSEcorr([io = stderr,] image::Array{T,4}; &lt;keyword arguments&gt;)
T2mapSEcorr([io = stderr,] image::Array{T,4}, opts::T2mapOptions{T})</code></pre><p>Uses nonnegative least squares (NNLS) to compute T2 distributions in the presence of stimulated echos by optimizing the refocusing pulse flip angle. Records parameter maps and T2 distributions for further partitioning.</p><p><strong>Arguments</strong></p><ul><li><code>image</code>: 4D array with intensity data as <code>(row, column, slice, echo)</code></li><li>A series of optional keyword argument settings which will be used to construct a <a href="#DECAES.T2mapOptions"><code>T2mapOptions</code></a> struct internally, or a <a href="#DECAES.T2mapOptions"><code>T2mapOptions</code></a> struct directly</li></ul><p><strong>Outputs</strong></p><ul><li><code>maps</code>: dictionary containing parameter maps with the following fields:<ul><li><strong>Default Fields</strong><ul><li><code>&quot;echotimes&quot;</code>     Echo times of time signal (length <code>nTE</code> 1D array)</li><li><code>&quot;t2times&quot;</code>       T2 times corresponding to T2-distributions (length <code>nT2</code> 1D array)</li><li><code>&quot;refangleset&quot;</code>   Refocusing angles used during flip angle optimization (length <code>nRefAngles</code> 1D array by default; scalar if <code>SetFlipAngle</code> is used)</li><li><code>&quot;decaybasisset&quot;</code> Decay basis sets corresponding to <code>&quot;refangleset&quot;</code> (<code>nTE x nT2 x nRefAngles</code> 3D array by default; <code>nTE x nT2</code> 2D array if <code>SetFlipAngle</code> is used)</li><li><code>&quot;gdn&quot;</code>:          Map of general density = sum(T2distribution) (<code>MatrixSize</code> 3D array)</li><li><code>&quot;ggm&quot;</code>:          Map of general geometric mean of T2-distribution (<code>MatrixSize</code> 3D array)</li><li><code>&quot;gva&quot;</code>:          Map of general variance (<code>MatrixSize</code> 3D array)</li><li><code>&quot;fnr&quot;</code>:          Map of fit to noise ratio = gdn / sqrt(sum(residuals.^2) / (nTE-1)) (<code>MatrixSize</code> 3D array)</li><li><code>&quot;snr&quot;</code>:          Map of signal to noise ratio = maximum(signal) / std(residuals) (<code>MatrixSize</code> 3D array)</li><li><code>&quot;alpha&quot;</code>:        Map of optimized refocusing pulse flip angle (<code>MatrixSize</code> 3D array)</li></ul></li><li><strong>Optional Fields</strong><ul><li><code>&quot;resnorm&quot;</code>:      <span>$\ell^2$</span>-norm of NNLS fit residuals; see <code>SaveResidualNorm</code> option (<code>MatrixSize</code> 3D array)</li><li><code>&quot;decaycurve&quot;</code>:   Signal decay curve resulting from NNLS fit; see <code>SaveDecayCurve</code> option (<code>MatrixSize x nTE</code> 4D array)</li><li><code>&quot;mu&quot;</code>:           Regularization parameter used during from NNLS fit; see <code>SaveRegParam</code> option (<code>MatrixSize</code> 3D array)</li><li><code>&quot;chi2factor&quot;</code>:   <span>$\chi^2$</span> increase factor relative to unregularized NNLS fit; see <code>SaveRegParam</code> option (<code>MatrixSize</code> 3D array)</li><li><code>&quot;decaybasis&quot;</code>:   Decay bases resulting from flip angle optimization; see <code>SaveNNLSBasis</code> option (<code>MatrixSize x nTE x nT2</code> 5D array, or <code>nTE x nT2</code> 2D array if <code>SetFlipAngle</code> is used)</li></ul></li></ul></li><li><code>distributions</code>: T2-distribution array with data as <code>(row, column, slice, T2 amplitude)</code> (<code>MatrixSize x nT2</code> 4D array)</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; image = DECAES.mock_image(MatrixSize = (100,100,1), nTE = 32); # mock image with size 100x100x1x32

julia&gt; maps, dist = T2mapSEcorr(image; TE = 10e-3, nT2 = 40, T2Range = (10e-3, 2.0), Reg = &quot;lcurve&quot;, Silent = true); # compute the T2-maps and T2-distribution

julia&gt; maps
Dict{String, Any} with 10 entries:
  &quot;echotimes&quot;     =&gt; [0.01, 0.02, 0.03, 0.04, 0.05, 0.06, 0.07, 0.08, 0.09, 0.1  …  0.23, …
  &quot;t2times&quot;       =&gt; [0.01, 0.0114551, 0.013122, 0.0150315, 0.0172188, 0.0197244, 0.022594…
  &quot;refangleset&quot;   =&gt; [50.0, 54.1935, 58.3871, 62.5806, 66.7742, 70.9677, 75.1613, 79.3548,…
  &quot;gdn&quot;           =&gt; [185326.0 1.26487e5 … 1.85322e5 1.025e5; 1.48254e5 1.91871e5 … 1.5159…
  &quot;fnr&quot;           =&gt; [460.929 398.485 … 415.599 428.055; 316.05 340.206 … 372.7 410.487; ……
  &quot;alpha&quot;         =&gt; [165.348 164.657 … 163.031 166.735; 165.212 164.994 … 165.6 165.094; …
  &quot;gva&quot;           =&gt; [0.438218 0.330969 … 0.367929 0.350691; 0.287478 0.307593 … 0.3892 0.…
  &quot;ggm&quot;           =&gt; [0.0501681 0.0518976 … 0.0509003 0.0519268; 0.0535984 0.0528403 … 0.0…
  &quot;snr&quot;           =&gt; [357.763 317.439 … 322.451 340.88; 250.674 275.185 … 294.411 324.464;…
  &quot;decaybasisset&quot; =&gt; [0.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0; … ; 0.0 0.0 … 0.0 0.0; 0.0 0.0…</code></pre><p>See also:</p><ul><li><a href="#DECAES.T2partSEcorr"><code>T2partSEcorr</code></a></li><li><a href="#DECAES.lsqnonneg"><code>lsqnonneg</code></a></li><li><a href="#DECAES.lsqnonneg_chi2"><code>lsqnonneg_chi2</code></a></li><li><a href="#DECAES.lsqnonneg_gcv"><code>lsqnonneg_gcv</code></a></li><li><a href="#DECAES.lsqnonneg_lcurve"><code>lsqnonneg_lcurve</code></a></li><li><a href="#DECAES.EPGdecaycurve"><code>EPGdecaycurve</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jondeuce/DECAES.jl/blob/541249eca404be1e6e3442de8d780500c42cd6cb/src/T2mapSEcorr.jl#L1-L60">source</a></section></article><h2 id="t2part"><a class="docs-heading-anchor" href="#t2part"><span>$T_2$</span>-parts and the myelin water fraction</a><a id="t2part-1"></a><a class="docs-heading-anchor-permalink" href="#t2part" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="DECAES.T2partOptions" href="#DECAES.T2partOptions"><code>DECAES.T2partOptions</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">T2partOptions(; kwargs...)
T2partOptions(t2dist::Array{T,4}; kwargs...) where {T}</code></pre><p>Options structure for <a href="#DECAES.T2partSEcorr"><code>T2partSEcorr</code></a>. This struct collects keyword arguments passed to <code>T2partSEcorr</code>, performs checks on parameter types and values, and assigns default values to unspecified parameters.</p><p><strong>Arguments</strong></p><ul><li><p><code>legacy::Bool</code></p><p>Calculate T2-parts using legacy algorithms. Default: false</p></li><li><p><code>MatrixSize::Tuple{Int64, Int64, Int64}</code></p><p>Size of first 3 dimensions of input 4D T2 distribution. This argument is has no default, but is inferred automatically as <code>size(t2dist)[1:3]</code> when calling <code>T2partSEcorr(t2dist; kwargs...)</code>.</p></li><li><p><code>nT2::Int64</code></p><p>Number of T2 times to use. This argument has no default.</p></li><li><p><code>T2Range::Tuple{T, T} where T&lt;:Real</code></p><p>Tuple of min and max T2 values (Units: seconds). This argument has no default.</p></li><li><p><code>SPWin::Tuple{T, T} where T&lt;:Real</code></p><p>Tuple of min and max T2 values of the short peak window (Units: seconds). This argument has no default.</p></li><li><p><code>MPWin::Tuple{T, T} where T&lt;:Real</code></p><p>Tuple of min and max T2 values of the middle peak window (Units: seconds). This argument has no default.</p></li><li><p><code>Sigmoid::Union{Nothing, T} where T&lt;:Real</code></p><p>Apply sigmoidal weighting to the upper limit of the short peak window in order to smooth the hard small peak window cutoff time. <code>Sigmoid</code> is the delta-T2 parameter, which is the distance in seconds on either side of the <code>SPWin</code> upper limit where the sigmoid curve reaches 10% and 90% (Units: seconds). Default: nothing</p></li><li><p><code>Silent::Bool</code></p><p>Suppress printing to the console. Default: false</p></li></ul><p>See also:</p><ul><li><a href="#DECAES.T2partSEcorr"><code>T2partSEcorr</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jondeuce/DECAES.jl/blob/541249eca404be1e6e3442de8d780500c42cd6cb/src/types.jl#L120-L133">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DECAES.T2partSEcorr" href="#DECAES.T2partSEcorr"><code>DECAES.T2partSEcorr</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">T2partSEcorr([io = stderr,] T2distributions::Array{T,4}; &lt;keyword arguments&gt;)
T2partSEcorr([io = stderr,] T2distributions::Array{T,4}, opts::T2partOptions{T})</code></pre><p>Analyzes T2 distributions produced by <a href="#DECAES.T2mapSEcorr"><code>T2mapSEcorr</code></a> to produce data maps of a series of parameters.</p><p><strong>Arguments</strong></p><ul><li><code>T2distributions</code>: 4D array with data as <code>(row, column, slice, T2 amplitude)</code></li><li>A series of optional keyword argument settings which will be used to construct a <a href="#DECAES.T2partOptions"><code>T2partOptions</code></a> struct internally, or a <a href="#DECAES.T2partOptions"><code>T2partOptions</code></a> struct directly</li></ul><p><strong>Ouputs</strong></p><ul><li><code>maps</code>: a dictionary containing the following 3D data maps as fields:<ul><li><code>&quot;sfr&quot;</code>: small pool fraction, e.g. myelin water fraction (<code>MatrixSize</code> 3D array)</li><li><code>&quot;sgm&quot;</code>: small pool geometric mean T2 (<code>MatrixSize</code> 3D array)</li><li><code>&quot;mfr&quot;</code>: medium pool fraction, e.g. intra/extracellular water fraction (<code>MatrixSize</code> 3D array)</li><li><code>&quot;mgm&quot;</code>: medium pool geometric mean T2 (<code>MatrixSize</code> 3D array)</li></ul></li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; dist = DECAES.mock_T2_dist(MatrixSize = (100,100,1), nT2 = 40); # mock distribution with size 100x100x1x40

julia&gt; maps = T2partSEcorr(dist; T2Range = (10e-3, 2.0), SPWin = (10e-3, 25e-3), MPWin = (25e-3, 200e-3), Silent = true); # compute T2-parts maps

julia&gt; maps # MWF is contained in maps[&quot;sfr&quot;]
Dict{String, Any} with 4 entries:
  &quot;sgm&quot; =&gt; [0.0105638 0.0128673 … 0.0120685 0.0117591; 0.0108218 0.0139536 … 0.0118711 0.011…
  &quot;mfr&quot; =&gt; [0.879499 0.889248 … 0.886412 0.897167; 0.927041 0.887472 … 0.872513 0.89026; … ;…
  &quot;sfr&quot; =&gt; [0.120501 0.110752 … 0.113588 0.102833; 0.0729592 0.112528 … 0.127487 0.10974; … …
  &quot;mgm&quot; =&gt; [0.0621055 0.0617419 … 0.0612094 0.0615634; 0.0607907 0.0625588 … 0.0629157 0.062…</code></pre><p>See also:</p><ul><li><a href="#DECAES.T2mapSEcorr"><code>T2mapSEcorr</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jondeuce/DECAES.jl/blob/541249eca404be1e6e3442de8d780500c42cd6cb/src/T2partSEcorr.jl#L1-L34">source</a></section></article><h2 id="nnls"><a class="docs-heading-anchor" href="#nnls">NNLS analysis</a><a id="nnls-1"></a><a class="docs-heading-anchor-permalink" href="#nnls" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="DECAES.lsqnonneg" href="#DECAES.lsqnonneg"><code>DECAES.lsqnonneg</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">lsqnonneg(C::AbstractMatrix, d::AbstractVector)</code></pre><p>Returns the nonnegative least-squares (NNLS) solution, X, of the equation:</p><p class="math-container">\[X = \mathrm{argmin}_{x \ge 0} ||Cx - d||_2^2\]</p><p><strong>Arguments</strong></p><ul><li><code>C::AbstractMatrix</code>: Left hand side matrix acting on <code>x</code></li><li><code>d::AbstractVector</code>: Right hand side vector</li></ul><p><strong>Outputs</strong></p><ul><li><code>X::AbstractVector</code>: NNLS solution</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jondeuce/DECAES.jl/blob/541249eca404be1e6e3442de8d780500c42cd6cb/src/lsqnonneg.jl#L30-L45">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DECAES.lsqnonneg_chi2" href="#DECAES.lsqnonneg_chi2"><code>DECAES.lsqnonneg_chi2</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">lsqnonneg_chi2(C::AbstractMatrix, d::AbstractVector, Chi2Factor::Real)</code></pre><p>Returns the regularized NNLS solution, X, that incurrs an increase in <span>$\chi^2$</span> approximately by a factor of <code>Chi2Factor</code>. The regularized NNLS problem solved internally is:</p><p class="math-container">\[X = \mathrm{argmin}_{x \ge 0} ||Cx - d||_2^2 + \mu^2 ||x||_2^2\]</p><p>where <span>$\mu$</span> is determined by approximating a solution to the nonlinear equation</p><p class="math-container">\[\frac{\chi^2(\mu)}{\chi^2_{min}} = \mathrm{Chi2Factor}
\quad
\text{where}
\quad
\chi^2_{min} = \chi^2(\mu = 0)\]</p><p><strong>Arguments</strong></p><ul><li><code>C::AbstractMatrix</code>: Decay basis matrix</li><li><code>d::AbstractVector</code>: Decay curve data</li><li><code>Chi2Factor::Real</code>: Desired <span>$\chi^2$</span> increase due to regularization</li></ul><p><strong>Outputs</strong></p><ul><li><code>X::AbstractVector</code>: Regularized NNLS solution</li><li><code>mu::Real</code>: Resulting regularization parameter <span>$\mu$</span></li><li><code>Chi2Factor::Real</code>: Actual increase <span>$\chi^2(\mu)/\chi^2_{min}$</span>, which will be approximately equal to the input <code>Chi2Factor</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jondeuce/DECAES.jl/blob/541249eca404be1e6e3442de8d780500c42cd6cb/src/lsqnonneg_reg.jl#L193-L222">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DECAES.lsqnonneg_gcv" href="#DECAES.lsqnonneg_gcv"><code>DECAES.lsqnonneg_gcv</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">lsqnonneg_gcv(C::AbstractMatrix, d::AbstractVector)</code></pre><p>Returns the regularized NNLS solution, X, of the equation</p><p class="math-container">\[X = \mathrm{argmin}_{x \ge 0} ||Cx - d||_2^2 + \mu^2 ||L x||_2^2\]</p><p>where <span>$L$</span> is the identity matrix and <span>$\mu$</span> is chosen by the Generalized Cross-Validation (GCV) method.</p><p>Details of the GCV method and L-curve theory can be can be found in: <a href="https://doi.org/10.1137/1034115">Hansen, P.C., 1992. Analysis of Discrete Ill-Posed Problems by Means of the L-Curve. SIAM Review, 34(4), 561-580</a></p><p><strong>Arguments</strong></p><ul><li><code>C::AbstractMatrix</code>: Decay basis matrix</li><li><code>d::AbstractVector</code>: Decay curve data</li></ul><p><strong>Outputs</strong></p><ul><li><code>X::AbstractVector</code>: Regularized NNLS solution</li><li><code>mu::Real</code>: Resulting regularization parameter <span>$\mu$</span></li><li><code>Chi2Factor::Real</code>: Resulting increase in <span>$\chi^2$</span> relative to unregularized (<span>$\mu = 0$</span>) solution</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jondeuce/DECAES.jl/blob/541249eca404be1e6e3442de8d780500c42cd6cb/src/lsqnonneg_reg.jl#L950-L972">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DECAES.lsqnonneg_lcurve" href="#DECAES.lsqnonneg_lcurve"><code>DECAES.lsqnonneg_lcurve</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">lsqnonneg_lcurve(C::AbstractMatrix, d::AbstractVector)</code></pre><p>Returns the regularized NNLS solution, X, of the equation</p><p class="math-container">\[X = \mathrm{argmin}_{x \ge 0} ||Cx - d||_2^2 + \mu^2 ||L x||_2^2\]</p><p>where <span>$L$</span> is the identity matrix and <span>$\mu$</span> is chosen by locating the corner of the &quot;L-curve&quot;.</p><p>Details of L-curve theory and the Generalized Cross-Validation (GCV) method can be found in: <a href="https://doi.org/10.1137/1034115">Hansen, P.C., 1992. Analysis of Discrete Ill-Posed Problems by Means of the L-Curve. SIAM Review, 34(4), 561-580</a></p><p><strong>Arguments</strong></p><ul><li><code>C::AbstractMatrix</code>: Decay basis matrix</li><li><code>d::AbstractVector</code>: Decay curve data</li></ul><p><strong>Outputs</strong></p><ul><li><code>X::AbstractVector</code>: Regularized NNLS solution</li><li><code>mu::Real</code>: Resulting regularization parameter <span>$\mu$</span></li><li><code>Chi2Factor::Real</code>: Resulting increase in <span>$\chi^2$</span> relative to unregularized (<span>$\mu = 0$</span>) solution</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jondeuce/DECAES.jl/blob/541249eca404be1e6e3442de8d780500c42cd6cb/src/lsqnonneg_reg.jl#L549-L571">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DECAES.lcurve_corner" href="#DECAES.lcurve_corner"><code>DECAES.lcurve_corner</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">lcurve_corner(f, xlow, xhigh)</code></pre><p>Find the corner of the L-curve via curvature maximization using Algorithm 1 from:</p><p>A. Cultrera and L. Callegaro, “A simple algorithm to find the L-curve corner in the regularization of ill-posed inverse problems”. IOPSciNotes, vol. 1, no. 2, p. 025004, Aug. 2020, doi: 10.1088/2633-1357/abad0d</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jondeuce/DECAES.jl/blob/541249eca404be1e6e3442de8d780500c42cd6cb/src/lsqnonneg_reg.jl#L598-L605">source</a></section></article><h2 id="epg"><a class="docs-heading-anchor" href="#epg">Extended phase graph algorithm</a><a id="epg-1"></a><a class="docs-heading-anchor-permalink" href="#epg" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="DECAES.EPGdecaycurve" href="#DECAES.EPGdecaycurve"><code>DECAES.EPGdecaycurve</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">EPGdecaycurve(ETL::Int, flip_angle::Real, TE::Real, T2::Real, T1::Real, refcon::Real)</code></pre><p>Computes the normalized echo decay curve for a MR spin echo sequence using the extended phase graph algorithm using the given input parameters.</p><p><strong>Arguments</strong></p><ul><li><code>ETL::Int</code>:         echo train length, i.e. number of echos</li><li><code>flip_angle::Real</code>: angle of refocusing pulses (Units: degrees)</li><li><code>TE::Real</code>:         inter-echo time (Units: seconds)</li><li><code>T2::Real</code>:         transverse relaxation time (Units: seconds)</li><li><code>T1::Real</code>:         longitudinal relaxation time (Units: seconds)</li><li><code>refcon::Real</code>:     value of Refocusing Pulse Control Angle (Units: degrees)</li></ul><p><strong>Outputs</strong></p><ul><li><code>decay_curve::AbstractVector</code>: normalized echo decay curve with length <code>ETL</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jondeuce/DECAES.jl/blob/541249eca404be1e6e3442de8d780500c42cd6cb/src/EPGdecaycurve.jl#L33-L49">source</a></section></article><h2 id="main"><a class="docs-heading-anchor" href="#main">Main entrypoint function</a><a id="main-1"></a><a class="docs-heading-anchor-permalink" href="#main" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="DECAES.main" href="#DECAES.main"><code>DECAES.main</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">main(command_line_args = ARGS)</code></pre><p>Entry point function for command line interface, parsing the command line arguments <code>ARGS</code> and subsequently calling one or both of <code>T2mapSEcorr</code> and <code>T2partSEcorr</code> with the parsed settings. See the <a href="../cli/#Arguments">Arguments</a> section for available options.</p><p>See also:</p><ul><li><a href="#DECAES.T2mapSEcorr"><code>T2mapSEcorr</code></a></li><li><a href="#DECAES.T2partSEcorr"><code>T2partSEcorr</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jondeuce/DECAES.jl/blob/541249eca404be1e6e3442de8d780500c42cd6cb/src/main.jl#L179-L188">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../cli/">« Command Line Interface</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.5 on <span class="colophon-date" title="Thursday 5 August 2021 21:56">Thursday 5 August 2021</span>. Using Julia version 1.6.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
