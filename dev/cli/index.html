<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Command Line Interface · DECAES.jl</title><meta name="title" content="Command Line Interface · DECAES.jl"/><meta property="og:title" content="Command Line Interface · DECAES.jl"/><meta property="twitter:title" content="Command Line Interface · DECAES.jl"/><meta name="description" content="Documentation for DECAES.jl."/><meta property="og:description" content="Documentation for DECAES.jl."/><meta property="twitter:description" content="Documentation for DECAES.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="DECAES.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">DECAES.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Command Line Interface</a><ul class="internal"><li><a class="tocitem" href="#Using-the-CLI"><span>Using the CLI</span></a></li><li><a class="tocitem" href="#File-types"><span>File types</span></a></li><li><a class="tocitem" href="#Arguments"><span>Arguments</span></a></li><li><a class="tocitem" href="#Outputs"><span>Outputs</span></a></li><li><a class="tocitem" href="#Examples"><span>Examples</span></a></li></ul></li><li><a class="tocitem" href="../ref/">API Reference</a></li><li><a class="tocitem" href="../internals/">Internals</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Command Line Interface</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Command Line Interface</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/jondeuce/DECAES.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/jondeuce/DECAES.jl/blob/master/docs/src/cli.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Command-Line-Interface"><a class="docs-heading-anchor" href="#Command-Line-Interface">Command Line Interface</a><a id="Command-Line-Interface-1"></a><a class="docs-heading-anchor-permalink" href="#Command-Line-Interface" title="Permalink"></a></h1><p>DECAES provides a command line interface (CLI) for calling the main analysis functions: <a href="../ref/#DECAES.T2mapSEcorr"><code>T2mapSEcorr</code></a> for computing <span>$T_2$</span>-distributions, and <a href="../ref/#DECAES.T2partSEcorr"><code>T2partSEcorr</code></a> for running <span>$T_2$</span>-parts analysis on the resulting <span>$T_2$</span>-distributions for computing measures such as the myelin water fraction.</p><h2 id="Using-the-CLI"><a class="docs-heading-anchor" href="#Using-the-CLI">Using the CLI</a><a id="Using-the-CLI-1"></a><a class="docs-heading-anchor-permalink" href="#Using-the-CLI" title="Permalink"></a></h2><p>There are two equivalent ways to use the <a href="https://jondeuce.github.io/DECAES.jl/dev/cli">command line interface (CLI)</a>, assuming DECAES is already <a href="../#installation">installed</a>:</p><p><strong>1. (Recommended) <code>decaes</code> launcher:</strong> Use the script <code>~/.julia/bin/decaes</code> which comes with DECAES:</p><pre><code class="language-bash hljs">$ decaes &lt;COMMAND LINE ARGS&gt;</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Add <code>~/.julia/bin</code> to your <code>PATH</code> to avoid writing the full path <code>~/.julia/bin/decaes</code>.</p></div></div><p><strong>2. Julia <code>-e</code> flag:</strong> Call the DECAES CLI from Julia directly using the <code>-e</code> (for &quot;evaluate&quot;) flag:</p><pre><code class="language-bash hljs">$ julia --project=@decaes --threads=auto -e &#39;using DECAES; main()&#39; -- &lt;COMMAND LINE ARGS&gt;</code></pre><p>The <code>decaes</code> launcher is in fact just a thin wrapper script around a command like this one.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The flag <code>--threads=auto</code> enables parallel processing, which is critical for maximizing DECAES performance.</p></div></div><p>Either way of calling the CLI forwards the arguments <code>&lt;COMMAND LINE ARGS&gt;</code> to the entrypoint function <a href="../ref/#DECAES.main"><code>main</code></a>. Available command line arguments are detailed in the <a href="#Arguments">Arguments</a> section.</p><p>For the remainder of this section, we will make use of the <code>decaes</code> launcher.</p><h2 id="File-types"><a class="docs-heading-anchor" href="#File-types">File types</a><a id="File-types-1"></a><a class="docs-heading-anchor-permalink" href="#File-types" title="Permalink"></a></h2><p>Input files must be one of the following file types:</p><ol><li><a href="https://nifti.nimh.nih.gov/">NIfTI file</a> with extension <code>.nii</code>, or <a href="https://www.gzip.org/">gzip</a> compressed NIfTI file with extension <code>.nii.gz</code>. See <a href="https://github.com/JuliaIO/NIfTI.jl">NIfTI.jl</a> for more information.</li><li><a href="https://www.mathworks.com/help/matlab/import_export/mat-file-versions.html">MATLAB file</a> with extension <code>.mat</code>. <strong>Note:</strong> <code>.mat</code> files saved in the oldest format <code>v4</code> are not supported, but all newer formats (<code>v6</code>, <code>v7</code>, and <code>v7.3</code>) are supported. See <a href="https://github.com/JuliaIO/MAT.jl">MAT.jl</a> for more information.</li><li>Philips <a href="https://www.nitrc.org/plugins/mwiki/index.php/dcm2nii:MainPage#Philips_PAR.2FREC_Images">PAR/REC</a> file pair with extensions <code>.par</code> and <code>.rec</code> (or <code>.PAR</code> and <code>.REC</code>).</li><li>Philips XML/REC file pair with extensions <code>.xml</code> and <code>.rec</code> (or <code>.XML</code> and <code>.REC</code>).</li></ol><p>All output files are saved as <code>.mat</code> files in format <code>v7.3</code>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>If your data is in DICOM format, the <a href="https://www.nitrc.org/plugins/mwiki/index.php/dcm2nii:MainPage">freely available <code>dcm2niix</code> tool</a> is able to convert <a href="https://www.nitrc.org/plugins/mwiki/index.php/dcm2nii:MainPage#General_Usage">DICOM</a> files into NIfTI format</p></div></div><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><ul><li>Input files are interpreted as 4D arrays (or 3D arrays for mask files) when loaded; ensure that the underlying data is stored with the first three dimensions as (row, column, slice), and the last dimension as echo (or <span>$T_2$</span> bin, or omitted for mask files)</li><li>Images read from NIfTI and PAR/XML/REC files are coerced into the appropriate dimension; errors or unexpected behaviour may occur if the data is not stored with the correct dimensions</li><li>MATLAB files are searched for arrays with the appropriate dimension; the first such array that is found is used, otherwise an error will occur. <strong>Multiple 3D/4D arrays should not be stored in the same <code>.mat</code> file)</strong></li></ul></div></div><h2 id="Arguments"><a class="docs-heading-anchor" href="#Arguments">Arguments</a><a id="Arguments-1"></a><a class="docs-heading-anchor-permalink" href="#Arguments" title="Permalink"></a></h2><p>Available command line arguments are broken into four categories:</p><ol><li><strong>Positional arguments:</strong> these are the input files. Input files are typically placed at the beginning of <code>&lt;COMMAND LINE ARGS&gt;</code>.</li><li><strong>Optional arguments:</strong> settings governing the analysis pipeline. See below for details.</li><li><strong><a href="../ref/#DECAES.T2mapSEcorr"><code>T2mapSEcorr</code></a>/<a href="../ref/#DECAES.T2partSEcorr"><code>T2partSEcorr</code></a> arguments:</strong> settings for computing the <span>$T_2$</span>-distribution and subsequent <span>$T_2$</span>-parts analysis. Required arguments are listed first; see below for the full parameter list, and see <a href="../ref/#DECAES.T2mapSEcorr"><code>T2mapSEcorr</code></a> and <a href="../ref/#DECAES.T2partSEcorr"><code>T2partSEcorr</code></a> for parameter descriptions. Note: if no default is shown, the parameter is unused by default.</li><li><strong>B1 correction and stimulated echo correction:</strong> settings for controlling B1 correction and stimulated echo correction. These settings typically need not be modified. However, the following options are noteworthy: <code>--SetFlipAngle</code> allows for prescribing a fixed flip angle for all voxels instead of estimating the flip angle per-voxel; and <code>--B1map</code> allows for passing B1 maps (units of degrees) directly, replacing the flip angle estimation step.</li><li><strong>Additional save options:</strong> optional additional output maps</li><li><strong><a href="#bet">BET</a> arguments:</strong> settings for governing automatic brain mask generation using the BET brain extraction tool; <a href="#bet">see below</a> for details.</li></ol><pre class="documenter-example-output"><code class="nohighlight hljs ansi">usage: decaes [-m MASK [MASK...]] [-o OUTPUT [OUTPUT...]] [--T2map]
              [--T2part] [-q] [--dry] [--legacy]
              [--MatrixSize MATRIXSIZE MATRIXSIZE MATRIXSIZE]
              [--nTE NTE] [--TE TE] [--nT2 NT2]
              [--T2Range T2RANGE T2RANGE] [--SPWin SPWIN SPWIN]
              [--MPWin MPWIN MPWIN] [--Reg REG]
              [--RegParams REGPARAMS [REGPARAMS...]]
              [--Chi2Factor CHI2FACTOR] [--T1 T1] [--Sigmoid SIGMOID]
              [--Threshold THRESHOLD] [--B1map B1MAP [B1MAP...]]
              [--nRefAngles NREFANGLES]
              [--nRefAnglesMin NREFANGLESMIN]
              [--MinRefAngle MINREFANGLE]
              [--SetFlipAngle SETFLIPANGLE]
              [--RefConAngle REFCONANGLE] [--SaveDecayCurve]
              [--SaveNNLSBasis] [--SaveRegParam] [--SaveResidualNorm]
              [--bet] [--betargs BETARGS] [--betpath BETPATH]
              [input...]

positional arguments:
  input                 one or more input filenames. Valid file types
                        are limited to: .mat, .nii, .nii.gz, .par,
                        .xml, and .rec

optional arguments:
  -m, --mask MASK [MASK...]
                        one or more mask filenames. Masks are loaded
                        and subsequently applied to the corresponding
                        input files via elementwise multiplication.
                        The number of mask files must equal the number
                        of input files. Valid file types are the same
                        as for input files, and are limited to: .mat,
                        .nii, .nii.gz, .par, .xml, and .rec
  -o, --output OUTPUT [OUTPUT...]
                        one or more output directories. If not
                        specified, output file(s) will be stored in
                        the same location as the corresponding input
                        file(s). If one folder is passed, all output
                        files from all processed images will be stored
                        in the same folder. Otherwise, the number of
                        output folders must equal the number of input
                        files. Outputs are stored with the same
                        basename as the input files with additional
                        suffixes; see --T2map and --T2part
  --T2map               call T2mapSEcorr to compute T2 distributions
                        from 4D multi spin-echo input images. T2
                        distributions and T2 maps produced by
                        T2mapSEcorr are saved as MAT files with
                        extensions .t2dist.mat and .t2maps.mat
  --T2part              call T2partSEcorr to analyze 4D T2
                        distributions to produce parameter maps. If
                        --T2map is also passed, input 4D arrays are
                        interpreted as multi spin-echo images and T2
                        distributions are first computed by
                        T2mapSEcorr. If only --T2part is passed, input
                        4D arrays are interpreted as T2 distributions
                        and only T2partSEcorr is called. Output T2
                        parts are saved as a MAT file with extension
                        .t2parts.mat
  -q, --quiet           suppress printing to the terminal. Note: all
                        terminal outputs, including errors and
                        warnings, are still printed to the log file
  --dry                 execute dry run of processing without saving
                        any results
  --legacy              use legacy settings and algorithms from the
                        original MATLAB pipeline. Note: this flag is
                        now deprecated and will be removed in future
                        releases

T2map/T2part required parameters:
  --MatrixSize MATRIXSIZE MATRIXSIZE MATRIXSIZE
                        matrix size of the magnitude image. Inferred
                        automatically as the first three dimensions of
                        the input 4D image (type: Int64)
  --nTE NTE             number of echoes of the magnitude image.
                        Inferred automatically as the last dimension
                        of the input 4D image (type: Int64)
  --TE TE               inter-echo spacing. Required when --T2map is
                        passed. (units: seconds) (type: Float64)
  --nT2 NT2             number of T2 components used in the
                        multi-exponential analysis. Required when
                        --T2map is passed. Inferred from fourth
                        dimension of input image if only --T2part and
                        not --T2map is passed (type: Int64)
  --T2Range T2RANGE T2RANGE
                        minimum and maximum T2 values. T2 components
                        are logarithmically spaced between these
                        bounds. Required parameter. (units: seconds)
                        (type: Float64)
  --SPWin SPWIN SPWIN   minimum and maximum T2 values of the short
                        peak window. Required parameter when --T2part
                        is passed. (units: seconds) (type: Float64)
  --MPWin MPWIN MPWIN   minimum and maximum T2 values of the middle
                        peak window. Required parameter when --T2part
                        is passed. (units: seconds) (type: Float64)
  --Reg REG             method used for choosing the Tikhonov
                        regularization parameter. One of &quot;lcurve&quot;,
                        &quot;gcv&quot;, &quot;chi2&quot;, &quot;mdp&quot;, or &quot;none&quot;. These flags
                        correspond to the L-curve method, generalized
                        cross-validation, the chi-squared method,
                        Morozov&#39;s discrepency principle, and zero
                        regularization. Required parameter
  --RegParams REGPARAMS [REGPARAMS...]
                        parameters for the regularization method
                        chosen via --Reg. Required parameter if
                        --Reg=&quot;chi2&quot; or --Reg=&quot;mdp&quot; (type: Float64)
  --Chi2Factor CHI2FACTOR
                        if --Reg=&quot;chi2&quot;, the T2 distribution is
                        regularized such that the chi^2 goodness of
                        fit is increased by a multiplicative factor
                        --Chi2Factor relative to the unregularized
                        solution. Required parameter when
                        --Reg=&quot;chi2&quot;. Note: this flag is now
                        deprecated and will be removed in future
                        releases; use --RegParams instead (type:
                        Float64)

T2map/T2part optional parameters:
  --T1 T1               assumed value of longitudinal T1 relaxation.
                        (default: 1.0) (units: seconds) (type:
                        Float64)
  --Sigmoid SIGMOID     replace the hard upper limit cutoff time of
                        the short peak window, SPWin[2], with a
                        smoothed sigmoidal cutoff function &#39;σ&#39; scaled
                        and shifted such that σ(SPWin[2] +/- Sigmoid)
                        = 0.5 -/+ 0.4. Sigmoid is the time scale of
                        the smoothing. (units: seconds) (type:
                        Float64)
  --Threshold THRESHOLD
                        first echo intensity cutoff for empty voxels.
                        Processing is skipped for voxels with
                        intensity &lt;= --Threshold. (default: 0.0)
                        (units: signal magnitude) (type: Float64)

B1 correction and stimulated echo correction:
  --B1map B1MAP [B1MAP...]
                        one or more B1 map filenames. The B1 maps must
                        have the same matrix sizes as the
                        corresponding images, and are assumed to
                        represent flip angles in units of degrees. The
                        number of B1 map files must equal the number
                        of input files. Valid file types are the same
                        as for input files, and are limited to: .mat,
                        .nii, .nii.gz, .par, .xml, and .rec. (units:
                        degrees)
  --nRefAngles NREFANGLES
                        in estimating the local refocusing flip angle
                        to correct for B1 inhomogeneities, up to
                        --nRefAngles angles in the range
                        [--MinRefAngle, 180] are explicitly checked.
                        The optimal angle is then estimated by
                        interpolating between these observations.
                        (default: 32) (type: Int64)
  --nRefAnglesMin NREFANGLESMIN
                        initial number of angles in the range
                        [--MinRefAngle, 180] to check during flip
                        angle estimation before refinement near likely
                        optima. Setting --nRefAnglesMin equal to
                        --nRefAngles forces all candidate angles to be
                        checked before interpolation. (default: 5)
                        (type: Int64)
  --MinRefAngle MINREFANGLE
                        minimum refocusing angle for flip angle
                        estimation. (default: 50.0) (units: degrees)
                        (type: Float64)
  --SetFlipAngle SETFLIPANGLE
                        to skip B1 inhomogeneity correction, use
                        --SetFlipAngle to assume a fixed refocusing
                        flip angle for all voxels. (units: degrees)
                        (type: Float64)
  --RefConAngle REFCONANGLE
                        refocusing pulse control angle. The sequence
                        of flip angles used within the extended phase
                        graph algorithm to perform stimulated echo
                        correction is (90, 180, β, β, ..., β), where β
                        is the refocusing pulse control angle. For
                        typical multi spin-echo sequences this
                        parameter should not be changed. (default:
                        180.0) (units: degrees) (type: Float64)

Additional save options:
  --SaveDecayCurve      include a 4D array of the time domain decay
                        curves resulting from the NNLS fits in the
                        output maps dictionary
  --SaveNNLSBasis       include a 5D (or 2D if --SetFlipAngle is used)
                        array of NNLS basis matrices in the output
                        maps dictionary. Note: this 5D array is
                        extremely large for typical image sizes; in
                        most cases, this flag should only be set when
                        debugging small images
  --SaveRegParam        include 3D arrays of resulting regularization
                        parameters and χ² factors in the output maps
                        dictionary
  --SaveResidualNorm    include a 3D array of the l2-norms of the
                        residuals from the NNLS fits in the output
                        maps dictionary

BET arguments:
  --bet                 use the BET brain extraction tool from the FSL
                        library of analysis tools to automatically
                        create a binary brain mask. Only voxels within
                        the binary mask will be analyzed. Note that if
                        a mask is passed explicitly with the --mask
                        flag, this mask will be used and the --bet
                        flag will be ignored
  --betargs BETARGS     BET command line interface arguments. Must be
                        passed as a single string with arguments
                        separated by commas or spaces, e.g. &quot;-m,-n&quot;.
                        The flag &quot;-m&quot; indicates that a binary mask
                        should be computed, and therefore will be
                        added to the list of arguments if not provided
                        (default: &quot;-m -n -f 0.25 -R&quot;)
  --betpath BETPATH     path to BET executable (default: &quot;bet&quot;)</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>If desired, the <span>$T_2$</span>-distribution computation and the <span>$T_2$</span>-parts analysis may be performed separately:</p><ul><li>When the <code>--T2map</code> flag is passed, or both <code>--T2map</code> and <code>--T2part</code> flags are passed, input image arrays should be 4D with data as (row, column, slice, echo)</li><li>When only the <code>--T2part</code> flag is passed, input image arrays should be 4D with data as (row, column, slice, <span>$T_2$</span> bin)</li></ul></div></div><h2 id="Outputs"><a class="docs-heading-anchor" href="#Outputs">Outputs</a><a id="Outputs-1"></a><a class="docs-heading-anchor-permalink" href="#Outputs" title="Permalink"></a></h2><p>DECAES will produce up to five output files, each with the input filename (without suffix) used as a prefix. For example, if the input file is called <code>image.nii</code>, the possible output files are:</p><ol><li><code>image.t2dist.mat</code>: MATLAB file containing the 4D array of <span>$T_2$</span>-distributions (produced when <code>--T2map</code> flag is passed)</li><li><code>image.t2maps.mat</code>: MATLAB file containing <span>$T_2$</span>-distribution property maps and NNLS fit parameters; see <a href="../ref/#DECAES.T2mapSEcorr"><code>T2mapSEcorr</code></a> (produced when <code>--T2map</code> flag is passed)</li><li><code>image.t2parts.mat</code>: MATLAB file containing <span>$T_2$</span>-parts analysis results such as the MWF; see <a href="../ref/#DECAES.T2partSEcorr"><code>T2partSEcorr</code></a> (produced when <code>--T2part</code> flag is passed)</li><li><code>image.log</code>: Log file containing the console output</li><li><code>image.settings.txt</code>: Copy of settings file which was named <code>settings.txt</code> (produced when <a href="#settingsfiles">passing settings as a file</a>)</li></ol><p>If the <code>--dry</code> flag is passed, none of the above files will be produced.</p><h2 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h2><h3 id="defaultoptions"><a class="docs-heading-anchor" href="#defaultoptions">Default options</a><a id="defaultoptions-1"></a><a class="docs-heading-anchor-permalink" href="#defaultoptions" title="Permalink"></a></h3><p>Suppose you have a multi spin-echo image file <code>image.nii</code> which you would like to perform <span>$T_2$</span> analysis on. We can call <a href="../ref/#DECAES.T2mapSEcorr"><code>T2mapSEcorr</code></a> and <a href="../ref/#DECAES.T2partSEcorr"><code>T2partSEcorr</code></a> on the file <code>image.nii</code> using the <code>decaes</code> launcher. We pass the required arguments with the appropriate flags and leave the remaining parameters at default values:</p><pre class="documenter-example-output"><code class="nohighlight hljs ansi">$ decaes image.nii --T2map --T2part --TE 10e-3 --nT2 40 --T2Range 10e-3 2.0 --SPWin 10e-3 40e-3 --MPWin 40e-3 200.0e-3 --Reg lcurve</code></pre><p>After a few seconds, the script should begin running with the following messages appearing as the script progresses (note that real images will take longer to process than this toy example):</p><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr36"><span class="sgr1">[ Info: </span></span>Starting DECAES v0.6.1-DEV using Julia v1.10.5 with 4 threads
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Loading input file: image.nii.gz
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Done (0.02 seconds)
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Running T2mapSEcorr on file: image.nii.gz
<span class="sgr36"><span class="sgr1">┌ Info: </span></span>T2-distribution analysis settings:
<span class="sgr36"><span class="sgr1">│ </span></span>* Chi2Factor       : nothing
<span class="sgr36"><span class="sgr1">│ </span></span>* legacy           : false
<span class="sgr36"><span class="sgr1">│ </span></span>* MatrixSize       : (100, 100, 1)
<span class="sgr36"><span class="sgr1">│ </span></span>* MinRefAngle      : 50.0
<span class="sgr36"><span class="sgr1">│ </span></span>* NoiseLevel       : nothing
<span class="sgr36"><span class="sgr1">│ </span></span>* nRefAngles       : 64
<span class="sgr36"><span class="sgr1">│ </span></span>* nRefAnglesMin    : 5
<span class="sgr36"><span class="sgr1">│ </span></span>* nT2              : 40
<span class="sgr36"><span class="sgr1">│ </span></span>* nTE              : 48
<span class="sgr36"><span class="sgr1">│ </span></span>* RefConAngle      : 180.0
<span class="sgr36"><span class="sgr1">│ </span></span>* Reg              : lcurve
<span class="sgr36"><span class="sgr1">│ </span></span>* SaveDecayCurve   : false
<span class="sgr36"><span class="sgr1">│ </span></span>* SaveNNLSBasis    : false
<span class="sgr36"><span class="sgr1">│ </span></span>* SaveRegParam     : false
<span class="sgr36"><span class="sgr1">│ </span></span>* SaveResidualNorm : false
<span class="sgr36"><span class="sgr1">│ </span></span>* SetFlipAngle     : nothing
<span class="sgr36"><span class="sgr1">│ </span></span>* Silent           : false
<span class="sgr36"><span class="sgr1">│ </span></span>* T1               : 1.0
<span class="sgr36"><span class="sgr1">│ </span></span>* T2Range          : (0.01, 2.0)
<span class="sgr36"><span class="sgr1">│ </span></span>* TE               : 0.01
<span class="sgr36"><span class="sgr1">│ </span></span>* Threaded         : true
<span class="sgr36"><span class="sgr1">└ </span></span>* Threshold        : 0.0
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Done (1.89 seconds)
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Saving T2 distribution to file: image.t2dist.mat
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Done (0.04 seconds)
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Saving T2 parameter maps to file: image.t2maps.mat
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Done (0.11 seconds)
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Running T2partSEcorr
<span class="sgr36"><span class="sgr1">┌ Info: </span></span>T2-parts analysis settings:
<span class="sgr36"><span class="sgr1">│ </span></span>* legacy     : false
<span class="sgr36"><span class="sgr1">│ </span></span>* MatrixSize : (100, 100, 1)
<span class="sgr36"><span class="sgr1">│ </span></span>* MPWin      : (0.04, 0.2)
<span class="sgr36"><span class="sgr1">│ </span></span>* nT2        : 40
<span class="sgr36"><span class="sgr1">│ </span></span>* Sigmoid    : nothing
<span class="sgr36"><span class="sgr1">│ </span></span>* Silent     : false
<span class="sgr36"><span class="sgr1">│ </span></span>* SPWin      : (0.01, 0.04)
<span class="sgr36"><span class="sgr1">│ </span></span>* T2Range    : (0.01, 2.0)
<span class="sgr36"><span class="sgr1">└ </span></span>* Threaded   : true
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Done (0.0 seconds)
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Saving T2 parts maps to file: image.t2parts.mat
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Done (0.0 seconds)
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Finished (2.44 seconds)</code></pre><h3 id="settingsfiles"><a class="docs-heading-anchor" href="#settingsfiles">Settings files</a><a id="settingsfiles-1"></a><a class="docs-heading-anchor-permalink" href="#settingsfiles" title="Permalink"></a></h3><p>As there are several required parameters, it is convenient to store settings for DECAES in a settings file. Using the same options from the <a href="#defaultoptions">previous section</a>, we create a file <code>settings.txt</code> with the following contents:</p><pre><code class="nohighlight hljs">/path/to/image.nii
--T2map
--T2part
--TE
10e-3
--nT2
40
--T2Range
10e-3
2.0
--SPWin
10e-3
40e-3
--MPWin
40e-3
200.0e-3
--Reg
lcurve</code></pre><p>If this file is located at <code>/path/to/settings.txt</code>, simply prefix the filepath with the <code>@</code> character to have the file contents read into the <a href="../ref/#DECAES.main"><code>main</code></a> function:</p><pre class="documenter-example-output"><code class="nohighlight hljs ansi">$ decaes @/path/to/settings.txt</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><ul><li>The use of settings files is highly recommended for both reproducibility and for self-documentation. The input settings file will be automatically copied into the output folder for each processed image, with the image filename prepended. In this case, for example, the copied settings file would be called <code>image.settings.txt</code></li><li>Only one flag or value is allowed per line within a settings file. Flags which require multiple inputs (e.g. <code>--T2Range</code> above) must use one line for each input</li><li>The extension of the settings file is ignored; <code>.txt</code> is arbitrary in this example</li><li>Though not strictly necessary, using full input- and output paths in the settings file is convenient. This way, one doesn&#39;t rely on relative paths and can call e.g. <code>decaes @/path/to/settings.txt</code> from any directory</li></ul></div></div><h3 id="nondefault"><a class="docs-heading-anchor" href="#nondefault">Default settings files</a><a id="nondefault-1"></a><a class="docs-heading-anchor-permalink" href="#nondefault" title="Permalink"></a></h3><p>Suppose you have a default settings file <code>default.txt</code>, similar to the <code>settings.txt</code> file in the <a href="#settingsfiles">above section</a>. Settings in <code>default.txt</code> can be individually overridden. For example, if we are interested in changing the number of <span>$T_2$</span> bins <code>nT2</code> to 60, but leaving all other parameters the same, run the following:</p><pre class="documenter-example-output"><code class="nohighlight hljs ansi">$ decaes @/path/to/default.txt --nT2 60</code></pre><h3 id="multiinput"><a class="docs-heading-anchor" href="#multiinput">Multiple input files</a><a id="multiinput-1"></a><a class="docs-heading-anchor-permalink" href="#multiinput" title="Permalink"></a></h3><p>Multiple input files (possibly of different file types) can be passed in the obvious way:</p><pre class="documenter-example-output"><code class="nohighlight hljs ansi">$ decaes image1.nii image2.mat image3.nii.gz image4.par &lt;COMMAND LINE ARGS&gt;</code></pre><p>Equivalently, place multiple image paths at the top of your settings file, with each path on a new line.</p><h3 id="outfolder"><a class="docs-heading-anchor" href="#outfolder">Specify output folder</a><a id="outfolder-1"></a><a class="docs-heading-anchor-permalink" href="#outfolder" title="Permalink"></a></h3><p>By default, output files are saved in the same location as the corresponding input file. If you&#39;d like to save them in a different folder, you can use the <code>-o</code> or <code>--output</code> flag:</p><pre class="documenter-example-output"><code class="nohighlight hljs ansi">$ decaes image.nii --output /path/to/output/folder/ &lt;COMMAND LINE ARGS&gt;</code></pre><p>The requested output folder will be created if it does not already exist.</p><p>Equivalently, add <code>--output</code> and <code>/path/to/output/folder/</code> as consecutive lines in your settings file.</p><h3 id="passmasks"><a class="docs-heading-anchor" href="#passmasks">Passing image masks</a><a id="passmasks-1"></a><a class="docs-heading-anchor-permalink" href="#passmasks" title="Permalink"></a></h3><p>Image masks can be passed into DECAES using the <code>-m</code> or <code>--mask</code> flag:</p><pre class="documenter-example-output"><code class="nohighlight hljs ansi">$ decaes image.nii --mask /path/to/mask.nii &lt;COMMAND LINE ARGS&gt;</code></pre><p>The mask file is loaded and applied to the input image via elementwise multiplication over the spatial dimensions, e.g. the mask is applied to each echo of a 4D multi-echo input image.</p><p>If multiple image files are passed, multiple corresponding mask files can be passed, too:</p><pre class="documenter-example-output"><code class="nohighlight hljs ansi">$ decaes image1.nii image2.mat --mask /path/to/mask1.mat /path/to/mask2.nii.gz &lt;COMMAND LINE ARGS&gt;</code></pre><p>Equivalently, add <code>--mask</code>, <code>/path/to/mask1.mat</code>, <code>/path/to/mask2.mat</code>, ...  as consecutive lines in your settings file.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>If input images have been manually masked such that they are zero outside regions of interest, a mask need not be passed. The <code>--Threshold</code> parameter of <a href="../ref/#DECAES.T2mapSEcorr"><code>T2mapSEcorr</code></a> controls a first echo intensity cutoff threshold (default value 0.0), below which voxels are automatically skipped during processing</p></div></div><h3 id="bet"><a class="docs-heading-anchor" href="#bet">Automatic brain masking with BET</a><a id="bet-1"></a><a class="docs-heading-anchor-permalink" href="#bet" title="Permalink"></a></h3><p>The <a href="https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/BET/UserGuide">BET brain extraction tool</a> from the <a href="https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/FSL">FSL library of analysis tools</a> can be used to automatically generate a brain mask prior to analysis. Only voxels within the generated brain mask will be processed, greatly reducing analysis time. To use BET, pass the <code>--bet</code> flag:</p><pre class="documenter-example-output"><code class="nohighlight hljs ansi">$ decaes image.nii --bet &lt;COMMAND LINE ARGS&gt;</code></pre><p>If <code>bet</code> is not on your system path, you can pass the path to the <code>bet</code> binary with the <code>--betpath</code> flag. Additionally, you can pass arguments to <code>bet</code> with the <code>--betargs</code> flag:</p><pre class="documenter-example-output"><code class="nohighlight hljs ansi">$ decaes image.nii --bet --betpath /path/to/bet --betargs -m,-n &lt;COMMAND LINE ARGS&gt;</code></pre><p>Note that <code>bet</code> arguments must be passed as a single string to <code>--betargs</code>, separated by commas or spaces, as shown above.</p><p>Equivalently, add <code>--bet</code>, <code>--betpath</code>, <code>/path/to/bet</code>, <code>--betargs</code>, <code>-m,-n</code> as consecutive lines in your settings file.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>If a mask file is passed using the <code>--mask</code> flag, the <code>--bet</code> flag will be ignored and the mask file will be used</p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../ref/">API Reference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Wednesday 4 September 2024 20:55">Wednesday 4 September 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
